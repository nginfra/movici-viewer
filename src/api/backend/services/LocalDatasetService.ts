import Client from '@/flow/api/client';
import DatasetService from '@/flow/api/backend/dataset';
import { GetDatasetData, GetScenarioState } from '@/flow/requests';
import { ComponentProperty, Dataset, DatasetWithData, UUID } from '@/flow/types';
import { NumberSizeMap } from '@/flow/visualizers/maps/sizeMaps';

export default class LocalDatasetService implements DatasetService {
  client: Client;

  constructor(client: Client) {
    this.client = client;
  }

  async list(project_uuid: string) {
    return new Promise<Dataset[]>(resolve => {
      resolve([
        {
          uuid: '842512e6-b016-40d2-9b9a-87e0625a0835',
          name: 'impact_indicator_test',
          type: 'impact_indicator',
          display_name: 'Impact Indicator',
          created_on: 1598965490,
          last_modified: 1598965491,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: '139829a0-f8f7-4d56-8da6-f35dce15ed50',
          name: 'people_test',
          type: 'people_point_set',
          display_name: 'People',
          created_on: 1598965493,
          last_modified: 1598965493,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: '59270292-6dbd-4884-a400-c064bb6b2862',
          name: 'roads_test',
          type: 'road_line_set',
          display_name: 'Roads',
          created_on: 1598965524,
          last_modified: 1598965525,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: '5fefb50a-b132-4848-80ce-758ae7af9d06',
          name: 'poi_test',
          type: 'poi_point_set',
          display_name: 'POI',
          created_on: 1598965525,
          last_modified: 1598965526,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: 'ed25f110-a370-488f-92ad-0674c83c0d94',
          name: 'mv_network_test',
          type: 'mv_network',
          display_name: 'MV Network',
          created_on: 1598965526,
          last_modified: 1598965527,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: '8366bdcd-7ec8-41f4-a3e8-b4919be968a5',
          name: 'flooding_doorbraak_uitwateringssluis_subset',
          type: 'flooding_grid',
          display_name: 'Flooding',
          created_on: 1598965547,
          last_modified: 1598965548,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: 'e12c43eb-93e8-453a-b573-5fadaffe8a90',
          name: 'antennas_test',
          type: 'antenna_point_set',
          display_name: 'Antennas',
          created_on: 1598965496,
          last_modified: 1623232097,
          has_data: true,
          status: 'Done'
        },
        {
          uuid: 'a0fdc09c-a172-4862-9a4f-309c79c6d16f',
          name: 'building_height',
          type: 'building_polygon_set',
          display_name: 'Buildings',
          created_on: 1601453516,
          last_modified: 1601453607,
          has_data: true,
          status: 'Done'
        }
      ]);
    });
    // return (await this.client?.request(new GetDatasets(project_uuid))) ?? [];
  }

  async getData<T>(params: {
    datasetUUID: UUID;
    entityGroup?: string;
    properties?: ComponentProperty[];
  }): Promise<DatasetWithData<T> | null> {
    // const { datasetUUID, entityGroup, properties } = params;
    // return await this.client.request(new GetDatasetData<T>(datasetUUID, entityGroup, properties));
    return new Promise<DatasetWithData<T>>(resolve => {
      resolve(({
        bounding_box: null,
        created_on: 1598965496,
        data: {
          antenna_entities: {
            id: [
              0,
              1,
              2,
              3,
              4,
              5,
              6,
              7,
              8,
              9,
              10,
              11,
              12,
              13,
              14,
              15,
              16,
              17,
              18,
              19,
              20,
              21,
              22,
              23,
              24,
              25,
              26,
              27,
              28,
              29,
              30,
              31,
              32,
              33,
              34,
              35,
              36,
              37,
              38,
              39,
              40,
              41,
              42,
              43,
              44,
              45,
              46,
              47,
              48,
              49,
              50,
              51,
              52,
              53,
              54,
              55,
              56,
              57,
              58,
              59,
              60,
              61,
              62,
              63,
              64,
              65,
              66,
              67,
              68,
              69,
              70,
              71,
              72,
              73,
              74,
              75,
              76,
              77,
              78,
              79,
              80,
              81,
              82,
              83,
              84,
              85,
              86,
              87,
              88,
              89,
              90,
              91,
              92,
              93,
              94,
              95,
              96,
              97,
              98,
              99,
              100,
              101,
              102,
              103,
              104,
              105,
              106,
              107,
              108,
              109,
              110,
              111,
              112,
              113,
              114,
              115,
              116,
              117,
              118,
              119,
              120,
              121,
              122,
              123,
              124,
              125,
              126,
              127,
              128,
              129,
              130,
              131,
              132,
              133,
              134,
              135,
              136,
              137,
              138,
              139,
              140,
              141,
              142,
              143,
              144,
              145,
              146,
              147,
              148,
              149,
              150,
              151,
              152,
              153,
              154,
              155,
              156,
              157,
              158,
              159,
              160,
              161,
              162,
              163,
              164,
              165,
              166,
              167,
              168,
              169,
              170,
              171,
              172,
              173,
              174,
              175,
              176,
              177,
              178,
              179,
              180,
              181
            ],
            operation_status_properties: {
              has_power: [
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true,
                true
              ]
            }
          }
        },
        display_name: 'Antennas',
        epsg_code: 28992,
        format: 'entity_based',
        general: {
          enum: {
            label: ['distribution'],
            power_source: ['electricity_net', 'battery', 'no_power']
          }
        },
        has_data: true,
        last_modified: 1623232097,
        name: 'antennas_test',
        project_name: 'test_project',
        project_uuid: '1bf3d081-16e1-4353-966e-19f8fe47b3f3',
        type: 'antenna_point_set',
        uuid: 'e12c43eb-93e8-453a-b573-5fadaffe8a90',
        version: 3
      } as unknown) as DatasetWithData<T>);
    });
  }

  // https://staging.movici.nl/data-engine/v4/scenarios/b39c3fb6-86e2-4650-a582-93de2537cae8/summary?dataset_uuid=e12c43eb-93e8-453a-b573-5fadaffe8a90
  async getState<T>(params: {
    datasetUUID: UUID;
    scenarioUUID: UUID;
    entityGroup: string;
    properties: ComponentProperty[];
    timestamp: number;
  }): Promise<DatasetWithData<T> | null> {
    // const { datasetUUID, scenarioUUID, entityGroup, properties, timestamp } = params;

    // return await this.client.request(
    //   new GetScenarioState(datasetUUID, scenarioUUID, entityGroup, properties, timestamp)
    // );
    return new Promise(resolve =>
      resolve(({
        bounding_box: null,
        created_on: 1598965496,
        data: {
          antenna_entities: {
            id: [
              0,
              1,
              2,
              3,
              4,
              5,
              6,
              7,
              8,
              9,
              10,
              11,
              12,
              13,
              14,
              15,
              16,
              17,
              18,
              19,
              20,
              21,
              22,
              23,
              24,
              25,
              26,
              27,
              28,
              29,
              30,
              31,
              32,
              33,
              34,
              35,
              36,
              37,
              38,
              39,
              40,
              41,
              42,
              43,
              44,
              45,
              46,
              47,
              48,
              49,
              50,
              51,
              52,
              53,
              54,
              55,
              56,
              57,
              58,
              59,
              60,
              61,
              62,
              63,
              64,
              65,
              66,
              67,
              68,
              69,
              70,
              71,
              72,
              73,
              74,
              75,
              76,
              77,
              78,
              79,
              80,
              81,
              82,
              83,
              84,
              85,
              86,
              87,
              88,
              89,
              90,
              91,
              92,
              93,
              94,
              95,
              96,
              97,
              98,
              99,
              100,
              101,
              102,
              103,
              104,
              105,
              106,
              107,
              108,
              109,
              110,
              111,
              112,
              113,
              114,
              115,
              116,
              117,
              118,
              119,
              120,
              121,
              122,
              123,
              124,
              125,
              126,
              127,
              128,
              129,
              130,
              131,
              132,
              133,
              134,
              135,
              136,
              137,
              138,
              139,
              140,
              141,
              142,
              143,
              144,
              145,
              146,
              147,
              148,
              149,
              150,
              151,
              152,
              153,
              154,
              155,
              156,
              157,
              158,
              159,
              160,
              161,
              162,
              163,
              164,
              165,
              166,
              167,
              168,
              169,
              170,
              171,
              172,
              173,
              174,
              175,
              176,
              177,
              178,
              179,
              180,
              181
            ],
            point_properties: {
              position_x: [
                81758.0,
                81017.0,
                81027.0,
                81204.0,
                81364.0,
                81568.0,
                80178.0,
                81094.0,
                81384.0,
                81308.0,
                80965.0,
                81384.0,
                81608.0,
                81413.0,
                82000.0,
                80995.0,
                81886.0,
                81529.0,
                80989.0,
                81155.0,
                81568.0,
                82228.0,
                81690.0,
                81364.0,
                81685.0,
                81318.0,
                81130.0,
                81577.0,
                81982.0,
                80330.0,
                81500.0,
                80460.0,
                81886.0,
                81758.0,
                80995.0,
                80965.0,
                81900.0,
                81275.0,
                81320.0,
                81413.0,
                80182.0,
                81284.0,
                81608.0,
                81130.0,
                81474.0,
                81155.0,
                81712.0,
                81625.0,
                81510.0,
                82200.0,
                81913.0,
                81577.0,
                81320.0,
                81982.0,
                81360.0,
                80676.0,
                81571.0,
                81985.0,
                81506.0,
                80330.0,
                81967.0,
                82215.0,
                80676.0,
                80906.0,
                81622.0,
                81638.0,
                80460.0,
                81967.0,
                81318.0,
                81364.0,
                80178.0,
                82228.0,
                81712.0,
                81426.0,
                81762.0,
                81275.0,
                81694.0,
                81162.0,
                81094.0,
                81318.0,
                81622.0,
                80765.0,
                81529.0,
                81694.0,
                81189.0,
                80965.0,
                80676.0,
                81982.0,
                81025.0,
                81500.0,
                81638.0,
                81690.0,
                81218.0,
                81204.0,
                82228.0,
                81027.0,
                81568.0,
                80995.0,
                81218.0,
                81690.0,
                81625.0,
                81913.0,
                81886.0,
                80182.0,
                81900.0,
                81970.0,
                81364.0,
                81571.0,
                81025.0,
                80182.0,
                81900.0,
                81712.0,
                81027.0,
                80965.0,
                80676.0,
                82082.0,
                81320.0,
                81284.0,
                80925.0,
                82200.0,
                80906.0,
                81982.0,
                81275.0,
                80330.0,
                81094.0,
                81204.0,
                80460.0,
                81426.0,
                80178.0,
                81155.0,
                80906.0,
                81155.0,
                81130.0,
                80989.0,
                81506.0,
                81426.0,
                81759.0,
                82082.0,
                81025.0,
                82200.0,
                81384.0,
                81967.0,
                81162.0,
                82000.0,
                80710.0,
                81571.0,
                82215.0,
                81218.0,
                81261.0,
                82215.0,
                81762.0,
                81450.0,
                81970.0,
                81577.0,
                81474.0,
                80965.0,
                81218.0,
                80765.0,
                81985.0,
                81913.0,
                81346.0,
                80765.0,
                81762.0,
                81506.0,
                81284.0,
                82082.0,
                81694.0,
                80710.0,
                81308.0,
                80906.0,
                81758.0,
                81625.0,
                80989.0,
                81625.0,
                81320.0,
                80965.0,
                81284.0,
                80710.0,
                81625.0,
                82228.0,
                81413.0,
                81474.0
              ],
              position_y: [
                454993.0,
                455843.0,
                454129.0,
                454714.0,
                454965.0,
                455272.0,
                454539.0,
                455764.0,
                455136.0,
                454936.0,
                454766.0,
                455136.0,
                455571.0,
                455056.0,
                455225.0,
                454755.0,
                455164.0,
                455226.0,
                454735.0,
                454924.0,
                455272.0,
                454832.0,
                455340.0,
                455337.0,
                455432.0,
                454727.0,
                455204.0,
                455900.0,
                455109.0,
                455016.0,
                454900.0,
                454550.0,
                455164.0,
                454993.0,
                454755.0,
                454766.0,
                455175.0,
                455350.0,
                454780.0,
                455056.0,
                454544.0,
                455317.0,
                455571.0,
                455204.0,
                455047.0,
                454924.0,
                455047.0,
                454515.0,
                455164.0,
                454830.0,
                455289.0,
                455900.0,
                454780.0,
                455109.0,
                454961.0,
                455122.0,
                454892.0,
                455093.0,
                454879.0,
                455016.0,
                455332.0,
                454837.0,
                455122.0,
                454420.0,
                454980.0,
                455542.0,
                454550.0,
                455332.0,
                454727.0,
                455337.0,
                454539.0,
                454832.0,
                455047.0,
                454960.0,
                454752.0,
                455350.0,
                455337.0,
                454858.0,
                455764.0,
                454727.0,
                454980.0,
                455652.0,
                455226.0,
                455337.0,
                455130.0,
                454198.0,
                455122.0,
                455072.0,
                454129.0,
                454900.0,
                455542.0,
                455340.0,
                454559.0,
                454714.0,
                454832.0,
                454129.0,
                455272.0,
                454755.0,
                454559.0,
                455340.0,
                454515.0,
                455289.0,
                455164.0,
                454544.0,
                455175.0,
                455050.0,
                455337.0,
                454892.0,
                454129.0,
                454544.0,
                455175.0,
                455047.0,
                454129.0,
                454766.0,
                455122.0,
                455136.0,
                454930.0,
                455317.0,
                455290.0,
                454830.0,
                454420.0,
                455072.0,
                455350.0,
                455016.0,
                455764.0,
                454714.0,
                454550.0,
                454960.0,
                454539.0,
                454924.0,
                454420.0,
                454924.0,
                455204.0,
                454735.0,
                454879.0,
                454960.0,
                455058.0,
                455136.0,
                454129.0,
                454830.0,
                455136.0,
                455332.0,
                454858.0,
                455225.0,
                455630.0,
                454892.0,
                454837.0,
                454559.0,
                454885.0,
                454837.0,
                454752.0,
                454790.0,
                455050.0,
                455900.0,
                455047.0,
                454198.0,
                454559.0,
                455652.0,
                455093.0,
                455289.0,
                455075.0,
                455652.0,
                454752.0,
                454879.0,
                455317.0,
                455136.0,
                455337.0,
                455630.0,
                454936.0,
                454420.0,
                454993.0,
                454515.0,
                454735.0,
                455533.0,
                454780.0,
                454198.0,
                455317.0,
                455630.0,
                455533.0,
                454832.0,
                455056.0,
                455047.0
              ]
            }
          }
        },
        display_name: 'Antennas',
        epsg_code: 28992,
        format: 'entity_based',
        general: {
          enum: {
            label: ['distribution'],
            power_source: ['electricity_net', 'battery', 'no_power']
          }
        },
        has_data: true,
        last_modified: 1623232097,
        name: 'antennas_test',
        project_name: 'test_project',
        project_uuid: '1bf3d081-16e1-4353-966e-19f8fe47b3f3',
        type: 'antenna_point_set',
        uuid: 'e12c43eb-93e8-453a-b573-5fadaffe8a90',
        version: 3
      } as unknown) as DatasetWithData<T>)
    );
  }
}
